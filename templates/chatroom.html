{% extends "base.html" %}
{% load static %}

{% block title %}
    <title>Chatty</title>
{% endblock %}

{% block content %}
    <div class="flex flex-col h-screen justify-between bg-gray-100">

        <!-- Header -->
        <nav class="z-50 mx-auto w-full bg-blue-600 px-4 py-2">

            <!-- Navbar -->
            <div class="flex flex-row w-full justify-items-stretch">
                <h2 class="text-center place-self-center text-3xl font-bold leading-9 tracking-tight text-white">
                    Chats
                </h2>

                <!-- App Logo -->
                <figure class="flex mx-auto sm:w-full">
                    <img class="mx-auto w-20 h-20" src="{% static 'img/logo2.svg' %}" alt="speek-logo" />
                </figure>

                <!-- User Icon, Username, Logout button -->
                <div class="flex flex-row justify-between">

                    <!-- User icon -->
                    <div class="flex text-white space-x-4 bg-transparent rounded-sm cursor-pointer
                                justify-center md:flex-row hover:bg-blue-400 p-2">
                        <a href="{% url 'chat:chat-userprofile' user.id %}"
                           class="flex flex-row justify-between items-center">

                            <!-- Thumbnail of Profile Picture -->
                            <div class="w-16 h-16">
                                <img class="w-full h-full rounded-full" src="{{ user.profile.image.url }}" />
                            </div>

                            <!-- Name of Logged In User -->
                            <span class="flex ml-4 text-xl font-semibold">
                                {{ request.user }}
                            </span>
                        </a>
                    </div>

                    <!-- Logout Button -->
                    <form method="POST" action="{% url 'userlogout' %}" class="ml-6 inline-flex">
                        {% csrf_token %}
                        <button type="submit"
                            class="w-auto rounded-sm px-0 text-lg text-center leading-6 text-white
                                   shadow-sm hover:bg-none focus-visible:outline focus-visible:outline-2
                                   focus-visible:outline-offset-2 focus-visible:outline-red-500"
                        >
                            <svg
                                xmlns="http://www.w3.org/2000/svg"
                                viewBox="0 0 24 24"
                                fill="currentColor"
                                class="w-10 h-10 mx-auto font-extrabold text-red-400">
                                <path fill-rule="evenodd" d="M16.5 3.75a1.5 1.5 0 0 1 1.5 1.5v13.5a1.5 1.5 0 0 1-1.5 1.5h-6a1.5 1.5 0 0 1-1.5-1.5V15a.75.75 0 0 0-1.5 0v3.75a3 3 0 0 0 3 3h6a3 3 0 0 0 3-3V5.25a3 3 0 0 0-3-3h-6a3 3 0 0 0-3 3V9A.75.75 0 1 0 9 9V5.25a1.5 1.5 0 0 1 1.5-1.5h6ZM5.78 8.47a.75.75 0 0 0-1.06 0l-3 3a.75.75 0 0 0 0 1.06l3 3a.75.75 0 0 0 1.06-1.06l-1.72-1.72H15a.75.75 0 0 0 0-1.5H4.06l1.72-1.72a.75.75 0 0 0 0-1.06Z" clip-rule="evenodd" />
                            </svg>
                        </button>
                    </form>
                </div>
            </div>
        </nav>

        {% include 'snippets/messages.html' %}

        <!-- chat container -->
        <div id="chat" class="z-10 overflow-y-auto flex flex-1 flex-col pt-6 pb-6 mx-0">
        </div>

        <!-- Input and Submit -->
        <div id="chat-input" class="z-50 sticky flex flex-row h-20 space-x-0 p-0">
            <input id="chat-message-input"
                name="message"
                type="text"
                autocomplete="off"
                placeholder="Type a message..."
                class="w-full rounded-none border-0 py-4 text-gray-900 shadow-sm ring-1 ring-inset ring-gray-400
                       placeholder:text-gray-400 placeholder:text-lg placeholder:font-semibold font-semibold
                       text-lg focus:ring-2 focus:ring-inset focus:ring-indigo-600 sm:leading-6"
            >

            <!-- Send Message button -->
            <button id="chat-message-submit"
                    type="submit"
                    class="w-1/6 rounded-none bg-blue-600 px-3 py-4 text-xl text-center font-semibold leading-6
                           text-white shadow-sm hover:bg-blue-500 focus-visible:outline focus-visible:outline-2
                           focus-visible:outline-offset-2 focus-visible:outline-indigo-600"
            >
                <!-- Send Message icon -->
<!--                <span class="inline-flex items-center">-->
<!--                    <svg xmlns="http://www.w3.org/2000/svg"-->
<!--                         viewBox="0 0 24 24"-->
<!--                         fill="currentColor"-->
<!--                         class="w-8 h-8 mt-1 text-white font-extrabold">-->
<!--                        <path d="M3.478 2.404a.75.75 0 0 0-.926.941l2.432 7.905H13.5a.75.75 0 0 1 0 1.5H4.984l-2.432 7.905a.75.75 0 0 0 .926.94 60.519 60.519 0 0 0 18.445-8.986.75.75 0 0 0 0-1.218A60.517 60.517 0 0 0 3.478 2.404Z" />-->
<!--                    </svg>-->
<!--                </span>-->
                <span class="text-xl md:text-2xl font-semibold text-white">Send</span>
            </button>
        </div>
    </div>
{% endblock %}

{% block include_js %}
    {{ request.user.username|json_script:"request-user" }}
{% endblock %}

{% block domready %}
    <script src="{% static 'js/websocket.js' %}"></script>
{% endblock %}